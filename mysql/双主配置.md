# 主一数据库配置文件
```
[mysql]
default-character-set=utf8mb4
port=3308
[mysqld]
#skip-grant-tables
default_authentication_plugin=mysql_native_password
port=3308
basedir="D:\DataBase\Master1"
datadir="D:\DataBase\Master1\data"
character-set-server=utf8mb4
sql-mode="STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION"
max_connections=150
table_open_cache=256
tmp_table_size=32M
default-storage-engine=INNODB
innodb_flush_log_at_trx_commit="1"
innodb_log_buffer_size=1M
innodb_buffer_pool_size=128M
innodb_log_file_size=64M
innodb_thread_concurrency=100
server-id=8
log-bin=mysql-bin
auto-increment-increment = 1 #该服务器自增列增量
auto-increment-offset = 1 #该服务器自增列的初始值
log-slave-updates=1 #该从库是否写入二进制日志，如果需要成为多主则可启用。只读可以不需要
```

# 主二数据库配置文件
```
[mysql]
default-character-set=utf8mb4
port=3309
[mysqld]
#skip-grant-tables
default_authentication_plugin=mysql_native_password
port=3309
basedir="D:\DataBase\Master2"
datadir="D:\DataBase\Master2\data"
character-set-server=utf8mb4
sql-mode="STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION"
max_connections=150
table_open_cache=256
tmp_table_size=32M
default-storage-engine=INNODB
innodb_flush_log_at_trx_commit="1"
innodb_log_buffer_size=1M
innodb_buffer_pool_size=128M
innodb_log_file_size=64M
innodb_thread_concurrency=100

server-id=9
log-bin=mysql-bin
auto-increment-increment = 1 #该服务器自增列增量
auto-increment-offset = 1 #该服务器自增列的初始值
log-slave-updates=1 #该从库是否写入二进制日志，如果需要成为多主则可启用。只读可以不需要
```

# 配置双主复制的步骤：
### 1.在一号主库上创建一个用户用来复制。依次执行下面命令
```
mysql> create user 'master1'@'%' identified by '20140715';
mysql> grant replication slave,replication client on *.* to 'master1'@'%';
mysql> flush privileges;
```
### 2.在二号主库上创建一个用户用来复制。依次执行下面命令
```
mysql> create user 'master2'@'%' identified by '20140715';
mysql> grant replication slave,replication client on *.* to 'master2'@'%';
mysql> flush privileges;
```
### 3.在两个库上都执行 show master status 命令
```
mysql> show master status;
+------------------+----------+--------------+------------------+-------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+------------------+----------+--------------+------------------+-------------------+
| mysql-bin.000003 |     3011 | xiangqi_ros  | mysql            |                   |
+------------------+----------+--------------+------------------+-------------------+
1 row in set (0.01 sec)
```

### 4、在两个库上都执行以下命令，注意相应参数(master_log_file,master_log_pos)
#### 在一号库上执行的：
```
mysql> change master to master_host='localhost',master_port=3309,master_user='master2',master_password='123456',master_log_file='mysql-bin.000003',master_log_pos=852;
```
#### 在二号库上执行的：
```
mysql> change master to master_host='localhost',master_port=3308,master_user='master1',master_password='123456',master_log_file='mysql-bin.000003',master_log_pos=3011;
```

### 5.在两个库上都执行启动slave
```
mysql> start slave;
```

### 6.验证；show slave status;Slave_IO_Running与Slave_SQL_Running这两个值是否为yes，即设置成功了。
```
mysql> show slave status\G;
```